<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<title>Audio Waveform Visualizer</title>
<style>
  body {
    font-family: sans-serif;
    padding: 20px;
  }
  canvas {
    border: 1px solid #ccc;
    width: 100%;
    height: 200px;
  }
</style>
</head>
<body>

<h2>ðŸŽµ Audio Waveform Visualizer (.wav)</h2>
<input type="file" id="fileInput" accept=".wav,audio/wav" />
<br><br>
<canvas id="waveform" width="1000" height="200"></canvas>

<script>
const fileInput = document.getElementById('fileInput');
const canvas = document.getElementById('waveform');
const ctx = canvas.getContext('2d');

fileInput.addEventListener('change', async (e) => {
  const file = e.target.files[0];
  if (!file) return;

  const arrayBuffer = await file.arrayBuffer();
  const audioCtx = new (window.AudioContext || window.webkitAudioContext)();
  const audioBuffer = await audioCtx.decodeAudioData(arrayBuffer);

  drawWaveform(audioBuffer);
});

function drawWaveform(audioBuffer) {
  const channelData = audioBuffer.getChannelData(0); // mono / left channel
  const width = canvas.width;
  const height = canvas.height;
  const step = Math.ceil(channelData.length / width);
  const amp = height / 2;

  ctx.clearRect(0, 0, width, height);
  ctx.fillStyle = '#fff';
  ctx.fillRect(0, 0, width, height);

  ctx.beginPath();
  ctx.strokeStyle = '#0077ff';
  ctx.lineWidth = 1;

  for (let i = 0; i < width; i++) {
    let min = 1.0;
    let max = -1.0;

    for (let j = 0; j < step; j++) {
      const datum = channelData[(i * step) + j];
      if (datum < min) min = datum;
      if (datum > max) max = datum;
    }

    ctx.moveTo(i, (1 + min) * amp);
    ctx.lineTo(i, (1 + max) * amp);
  }

  ctx.stroke();
}
</script>

</body>
</html>
